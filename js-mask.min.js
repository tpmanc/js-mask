var PhoneMask=function(e,t){var n=this;t=t||{},this.elements=e,this.patternChar=t.patternChar||"_",this.prefix=t.prefix||"",this.pattern=t.pattern||"(___) ___-__-__",this.pattern=this.prefix+this.pattern,this.backspaceCode=t.backspaceCode||8,this.allowedRegExp=t.allowedRegExp||/^\d$/,this.igrogeKeyCodes=t.igrogeKeyCodes||[9,16,17,18,36,37,38,39,40,91,92,93];var r=function(e){e=e||window.event;var t=e.target||e.srcElement,r=!0;if(!n.isIgnoredKey(e.keyCode)){if(e.keyCode!=n.backspaceCode){var a=String.fromCharCode(e.keyCode);0!=n.allowedRegExp&&null==a.match(n.allowedRegExp)||(t.value=n.replaceToChar(t,a))}else t.value=n.replaceToPatternChar(t);r=!1}if(n.selectFirstPatterntChar(t),0==r)return e.preventDefault&&e.preventDefault(),r},a=function(e){e=e||window.event;var t=e.target||e.srcElement,r=t.value.indexOf(n.patternChar),a=r+1;r<0&&(r=t.value.length-1,a=r+1),n.selectCharInInput(t,r,a)};if("[object NodeList]"===Object.prototype.toString.call(this.elements))for(var o=0;o<this.elements.length;o++)this.elements[o].value=n.pattern,this.elements[o].onkeydown=r,this.elements[o].onfocus=a;else null!=this.elements&&(this.elements.value=n.pattern,this.elements.onkeydown=r,this.elements.onfocus=a)};PhoneMask.prototype.selectFirstPatterntChar=function(e){var t=e.value.indexOf(this.patternChar);if(t>-1){var n=t+1;this.selectCharInInput(e,t,n)}},PhoneMask.prototype.isIgnoredKey=function(e){return!(this.igrogeKeyCodes.indexOf(e)<0)},PhoneMask.prototype.selectCharInInput=function(e,t,n){e.setSelectionRange?(e.focus(),e.setSelectionRange(t,n)):e.createTextRange&&(range=e.createTextRange(),range.collapse(!0),range.moveEnd("character",n),range.moveStart("character",t),range.select())},PhoneMask.prototype.replaceAt=function(e,t,n){var r=e.split("");return r[t]=n,r.join("")},PhoneMask.prototype.replaceToChar=function(e,t){var n=e.value,r=n.indexOf(this.patternChar);return r>-1?this.replaceAt(n,r,t):n},PhoneMask.prototype.replaceToPatternChar=function(e){var t,n=e.value,r=n.indexOf(this.patternChar),a=!1;if(r==-1)t=n.length-1,a=!0;else for(t=r-1;!a;)if(this.pattern[t]!=n[t])a=!0;else if(t--,t<0)break;return a&&t>=this.prefix.length?this.replaceAt(n,t,this.patternChar):n},PhoneMask.prototype.destroy=function(){for(var e=0;e<this.elements.length;e++)this.elements[e].onkeydown=null,this.elements[e].onfocus=null};